!function(r){"use strict";r.MpegPlugin=function(d){console.log(Array(100).join("/"),"\n\tMpegPlugin\tV :",4),d=d||{};var f=document.createElement("span");function u(){f.lateTime=f.now()-f.targetTime;var e=Math.max(0,1e3/f.pictureRate-f.lateTime);function t(){r.requestAnimationFrame(f.nextFrame.bind(f),f.canvas)}f.targetTime=f.now()+e,f.benchmark?(f.benchFrame++,f.benchFrame>=120&&(f.benchAvgFrameTime=f.benchDecodeTimes/f.benchFrame,f.benchFrame=0,f.benchDecodeTimes=0,r.console&&console.log("Average time per frame:",f.benchAvgFrameTime,"ms")),setTimeout(f.nextFrame.bind(f),0)):e<18?t():setTimeout(t,e)}function D(){if(f.width=f.buffer.getBits(12),f.height=f.buffer.getBits(12),f.buffer.advance(4),f.pictureRate=t[f.buffer.getBits(4)],f.buffer.advance(30),f.intraQuantMatrix=o,f.nonIntraQuantMatrix=n,f.mbWidth=f.width+15>>4,f.mbHeight=f.height+15>>4,f.mbSize=f.mbWidth*f.mbHeight,f.codedWidth=f.mbWidth<<4,f.codedHeight=f.mbHeight<<4,f.codedSize=f.codedWidth*f.codedHeight,f.halfWidth=f.mbWidth<<3,f.halfHeight=f.mbHeight<<3,f.quarterSize=f.codedSize>>2,!f.sequenceStarted){f.sequenceStarted=!0;var e=r.Uint8ClampedArray||r.Uint8Array;r.Uint8ClampedArray||(U=_,M=Y),f.currentY=new e(f.codedSize),f.currentY32=new Uint32Array(f.currentY.buffer),f.currentCr=new e(f.codedSize>>2),f.currentCr32=new Uint32Array(f.currentCr.buffer),f.currentCb=new e(f.codedSize>>2),f.currentCb32=new Uint32Array(f.currentCb.buffer),f.forwardY=new e(f.codedSize),f.forwardY32=new Uint32Array(f.forwardY.buffer),f.forwardCr=new e(f.codedSize>>2),f.forwardCr32=new Uint32Array(f.forwardCr.buffer),f.forwardCb=new e(f.codedSize>>2),f.forwardCb32=new Uint32Array(f.forwardCb.buffer),f.canvas.width=f.width,f.canvas.height=f.height;var i=f.canvas;if(f.gl?(f.gl.useProgram(f.program),f.gl.viewport(0,0,i.width,i.height)):(f.currentRGBA=f.canvasContext.getImageData(0,0,i.width,i.height),f.fillArray(f.currentRGBA.data,255)),f.buffer.getBits(1)){for(var c=0;c<64;c++)f.customIntraQuantMatrix[a[c]]=f.buffer.getBits(8);f.intraQuantMatrix=f.customIntraQuantMatrix}if(f.buffer.getBits(1)){for(c=0;c<64;c++)f.customNonIntraQuantMatrix[a[c]]=f.buffer.getBits(8);f.nonIntraQuantMatrix=f.customNonIntraQuantMatrix}}}function k(r){var t=f.buffer;if(f.currentFrame++,f.currentTime=f.currentFrame/f.pictureRate,t.advance(10),f.pictureCodingType=t.getBits(3),t.advance(16),!(f.pictureCodingType<=0||f.pictureCodingType>=C)){if(f.pictureCodingType===h){if(f.fullPelForward=t.getBits(1),f.forwardFCode=t.getBits(3),0===f.forwardFCode)return;f.forwardRSize=f.forwardFCode-1,f.forwardF=1<<f.forwardRSize}var a=0;do{a=t.findNextMPEGStartCode()}while(a===F||a===y);for(;a>=T&&a<=x;)I(255&a),a=t.findNextMPEGStartCode();if(t.rewind(32),r!==e&&(f.renderFrame(),f.externalDecodeCallback.call(f,f.canvas)),f.pictureCodingType===g||f.pictureCodingType===h){var o=f.forwardY,n=f.forwardY32,i=f.forwardCr,c=f.forwardCr32,d=f.forwardCb,u=f.forwardCb32;f.forwardY=f.currentY,f.forwardY32=f.currentY32,f.forwardCr=f.currentCr,f.forwardCr32=f.currentCr32,f.forwardCb=f.currentCb,f.forwardCb32=f.currentCb32,f.currentY=o,f.currentY32=n,f.currentCr=i,f.currentCr32=c,f.currentCb=d,f.currentCb32=u}}}function I(r){for(f.sliceBegin=!0,f.macroblockAddress=(r-1)*f.mbWidth-1,f.motionFwH=f.motionFwHPrev=0,f.motionFwV=f.motionFwVPrev=0,f.dcPredictorY=128,f.dcPredictorCr=128,f.dcPredictorCb=128,f.quantizerScale=f.buffer.getBits(5);f.buffer.getBits(1);)f.buffer.advance(8);do{f.decodeMacroblock()}while(!f.buffer.nextBytesAreStartCode())}function B(r,e,t,a,o){var n,i,c,d,u,m,l,s,b,w,g,h,C,v,T,x,p,F,y,A=f.currentY32,E=f.currentCb32,P=f.currentCr32;if(i=(n=f.codedWidth)-16,c=r>>1,d=e>>1,u=1==(1&r),m=1==(1&e),l=((f.mbRow<<4)+d)*n+(f.mbCol<<4)+c,b=(s=f.mbRow*n+f.mbCol<<2)+(n<<2),u)if(m)for(;s<b;){for(g=t[l]+t[l+n],l++,w=0;w<4;w++)C=g+(h=t[l]+t[l+n])+2>>2&255,C|=(g=t[++l]+t[l+n])+h+2<<6&65280,C|=g+(h=t[++l]+t[l+n])+2<<14&16711680,g=t[++l]+t[l+n],l++,C|=g+h+2<<22&4278190080,A[s++]=C;s+=i>>2,l+=i-1}else for(;s<b;){for(g=t[l++],w=0;w<4;w++)C=g+(h=t[l++])+1>>1&255,C|=(g=t[l++])+h+1<<7&65280,C|=g+(h=t[l++])+1<<15&16711680,C|=(g=t[l++])+h+1<<23&4278190080,A[s++]=C;s+=i>>2,l+=i-1}else if(m)for(;s<b;){for(w=0;w<4;w++)C=t[l]+t[l+n]+1>>1&255,C|=t[++l]+t[l+n]+1<<7&65280,C|=t[++l]+t[l+n]+1<<15&16711680,C|=t[++l]+t[l+n]+1<<23&4278190080,l++,A[s++]=C;s+=i>>2,l+=i}else for(;s<b;){for(w=0;w<4;w++)C=t[l],C|=t[++l]<<8,C|=t[++l]<<16,C|=t[++l]<<24,l++,A[s++]=C;s+=i>>2,l+=i}if(i=(n=f.halfWidth)-8,c=r/2>>1,d=e/2>>1,u=1==(r/2&1),m=1==(e/2&1),l=((f.mbRow<<3)+d)*n+(f.mbCol<<3)+c,b=(s=f.mbRow*n+f.mbCol<<1)+(n<<1),u)if(m)for(;s<b;){for(v=a[l]+a[l+n],p=o[l]+o[l+n],l++,w=0;w<2;w++)x=v+(T=a[l]+a[l+n])+2>>2&255,y=p+(F=o[l]+o[l+n])+2>>2&255,x|=(v=a[++l]+a[l+n])+T+2<<6&65280,y|=(p=o[l]+o[l+n])+F+2<<6&65280,x|=v+(T=a[++l]+a[l+n])+2<<14&16711680,y|=p+(F=o[l]+o[l+n])+2<<14&16711680,v=a[++l]+a[l+n],p=o[l]+o[l+n],l++,x|=v+T+2<<22&4278190080,y|=p+F+2<<22&4278190080,P[s]=x,E[s]=y,s++;s+=i>>2,l+=i-1}else for(;s<b;){for(v=a[l],p=o[l],l++,w=0;w<2;w++)x=v+(T=a[l])+1>>1&255,y=p+(F=o[l++])+1>>1&255,x|=(v=a[l])+T+1<<7&65280,y|=(p=o[l++])+F+1<<7&65280,x|=v+(T=a[l])+1<<15&16711680,y|=p+(F=o[l++])+1<<15&16711680,x|=(v=a[l])+T+1<<23&4278190080,y|=(p=o[l++])+F+1<<23&4278190080,P[s]=x,E[s]=y,s++;s+=i>>2,l+=i-1}else if(m)for(;s<b;){for(w=0;w<2;w++)x=a[l]+a[l+n]+1>>1&255,y=o[l]+o[l+n]+1>>1&255,x|=a[++l]+a[l+n]+1<<7&65280,y|=o[l]+o[l+n]+1<<7&65280,x|=a[++l]+a[l+n]+1<<15&16711680,y|=o[l]+o[l+n]+1<<15&16711680,x|=a[++l]+a[l+n]+1<<23&4278190080,y|=o[l]+o[l+n]+1<<23&4278190080,l++,P[s]=x,E[s]=y,s++;s+=i>>2,l+=i}else for(;s<b;){for(w=0;w<2;w++)x=a[l],y=o[l],x|=a[++l]<<8,y|=o[l]<<8,x|=a[++l]<<16,y|=o[l]<<16,x|=a[++l]<<24,y|=o[l]<<24,l++,P[s]=x,E[s]=y,s++;s+=i>>2,l+=i}}function U(r,e,t,a){for(var o=0;o<64;o+=8,t+=a+8)e[t+0]=r[o+0],e[t+1]=r[o+1],e[t+2]=r[o+2],e[t+3]=r[o+3],e[t+4]=r[o+4],e[t+5]=r[o+5],e[t+6]=r[o+6],e[t+7]=r[o+7]}function M(r,e,t,a){for(var o=0;o<64;o+=8,t+=a+8)e[t+0]+=r[o+0],e[t+1]+=r[o+1],e[t+2]+=r[o+2],e[t+3]+=r[o+3],e[t+4]+=r[o+4],e[t+5]+=r[o+5],e[t+6]+=r[o+6],e[t+7]+=r[o+7]}function _(r,e,t,a){for(var o=0,n=0;n<8;n++){for(var i=0;i<8;i++){var c=r[o++];e[t++]=c>255?255:c<0?0:c}t+=a}}function Y(r,e,t,a){for(var o=0,n=0;n<8;n++){for(var i=0;i<8;i++){var c=r[o++]+e[t];e[t++]=c>255?255:c<0?0:c}t+=a}}function H(r){var e,t=0;if(f.macroblockIntra){var o,n;if(r<4?(o=f.dcPredictorY,n=f.readCode(s)):(o=4===r?f.dcPredictorCr:f.dcPredictorCb,n=f.readCode(b)),n>0){var c=f.buffer.getBits(n);f.blockData[0]=0!=(c&1<<n-1)?o+c:o+(-1<<n|c+1)}else f.blockData[0]=o;r<4?f.dcPredictorY=f.blockData[0]:4===r?f.dcPredictorCr=f.blockData[0]:f.dcPredictorCb=f.blockData[0],f.blockData[0]<<=8,e=f.intraQuantMatrix,t=1}else e=f.nonIntraQuantMatrix;for(var d,u,m,l=0;;){var g=0,h=f.readCode(w);if(1===h&&t>0&&0===f.buffer.getBits(1))break;65535===h?(g=f.buffer.getBits(6),0===(l=f.buffer.getBits(8))?l=f.buffer.getBits(8):128===l?l=f.buffer.getBits(8)-256:l>128&&(l-=256)):(g=h>>8,l=255&h,f.buffer.getBits(1)&&(l=-l));var C=a[t+=g];t++,l<<=1,f.macroblockIntra||(l+=l<0?-1:1),0==(1&(l=l*f.quantizerScale*e[C]>>4))&&(l-=l>0?1:-1),l>2047?l=2047:l<-2048&&(l=-2048),f.blockData[C]=l*i[C]}r<4?(d=f.currentY,m=f.codedWidth-8,u=f.mbRow*f.codedWidth+f.mbCol<<4,0!=(1&r)&&(u+=8),0!=(2&r)&&(u+=f.codedWidth<<3)):(d=4===r?f.currentCb:f.currentCr,m=(f.codedWidth>>1)-8,u=(f.mbRow*f.codedWidth<<2)+(f.mbCol<<3)),1===t?(f.macroblockIntra?function(r,e,t,a){for(var o=0;o<64;o+=8,t+=a+8)e[t+0]=r,e[t+1]=r,e[t+2]=r,e[t+3]=r,e[t+4]=r,e[t+5]=r,e[t+6]=r,e[t+7]=r}(f.blockData[0]+128>>8,d,u,m):function(r,e,t,a){for(var o=0;o<64;o+=8,t+=a+8)e[t+0]+=r,e[t+1]+=r,e[t+2]+=r,e[t+3]+=r,e[t+4]+=r,e[t+5]+=r,e[t+6]+=r,e[t+7]+=r}(f.blockData[0]+128>>8,d,u,m),f.blockData[0]=0):(!function(){var r,e,t,a,o,n,i,c,d,u,m,l,s,b,w,g,h,C,v,T=f.blockData;for(v=0;v<8;++v)r=T[32+v],e=T[16+v]+T[48+v],t=T[40+v]-T[24+v],n=T[8+v]+T[56+v],i=T[24+v]+T[40+v],a=T[8+v]-T[56+v],o=n+i,c=T[0+v],d=(s=(473*a-196*t+128>>8)-o)-(362*(n-i)+128>>8),u=c-r,m=(362*(T[16+v]-T[48+v])+128>>8)-e,b=u+m,w=(l=c+r)+e,g=u-m,h=l-e,C=-d-(473*t+196*a+128>>8),T[0+v]=o+w,T[8+v]=s+b,T[16+v]=g-d,T[24+v]=h-C,T[32+v]=h+C,T[40+v]=d+g,T[48+v]=b-s,T[56+v]=w-o;for(v=0;v<64;v+=8)r=T[4+v],e=T[2+v]+T[6+v],t=T[5+v]-T[3+v],n=T[1+v]+T[7+v],i=T[3+v]+T[5+v],a=T[1+v]-T[7+v],o=n+i,c=T[0+v],d=(s=(473*a-196*t+128>>8)-o)-(362*(n-i)+128>>8),u=c-r,m=(362*(T[2+v]-T[6+v])+128>>8)-e,b=u+m,w=(l=c+r)+e,g=u-m,h=l-e,C=-d-(473*t+196*a+128>>8),T[0+v]=o+w+128>>8,T[1+v]=s+b+128>>8,T[2+v]=g-d+128>>8,T[3+v]=h-C+128>>8,T[4+v]=h+C+128>>8,T[5+v]=d+g+128>>8,T[6+v]=b-s+128>>8,T[7+v]=w-o+128>>8}(),f.macroblockIntra?U(f.blockData,d,u,m):M(f.blockData,d,u,m),f.blockData.set(f.zeroBlockData)),t=0}f.tag=d.tag||document.createElement("video"),f.buffered=0,f.paused=!0,f.benchmark=!!d.benchmark,f.autoplay=!1!==d.autoplay,f.loop=!!d.loop,f.onReady=d.onReady||function(){},f.externalDecodeCallback=d.ondecodeframe||function(){},f.customIntraQuantMatrix=new Uint8Array(64),f.customNonIntraQuantMatrix=new Uint8Array(64),f.blockData=new Int32Array(64),f.zeroBlockData=new Int32Array(64),f.intraFrames=[],f.currentFrame=-1,f.currentTime=0,f.frameCount=0,f.duration=0,f.load=function(r){var e=new XMLHttpRequest;f.url=r,e.onreadystatechange=function(){e.readyState===e.DONE&&200===e.status&&function(r){f.buffer=new S(r),function(){var r;for(r=0;-1!==f.findStartCode(p);r++)f.buffer.advance(10),f.buffer.getBits(3)===g&&f.intraFrames.push({frame:r,index:f.buffer.index-13});f.frameCount=r}(),f.buffer.index=0,f.findStartCode(v),f.firstSequenceHeader=f.buffer.index,D(),f.duration=f.frameCount/f.pictureRate,f.nextFrame(),f.autoplay&&f.play();f.onReady.call(f)}(e.response)},e.onprogress=f.gl?function(r){var e=f.gl;e.uniform1f(e.getUniformLocation(f.loadingProgram,"loaded"),r.loaded/r.total),e.drawArrays(e.TRIANGLE_STRIP,0,4)}:function(r){var e=r.loaded/r.total,t=f.canvas.width,a=f.canvas.height,o=f.canvasContext;o.fillStyle="#222",o.fillRect(0,0,t,a),o.fillStyle="#fff",o.fillRect(0,a-a*e,t,a*e)},e.open("GET",r),e.responseType="arraybuffer",e.send()},f.play=function(){f.paused&&(f.tag.dispatchEvent(new CustomEvent("play")),f.tag.dispatchEvent(new CustomEvent("playing")),f.targetTime=f.now(),f.paused=!1,u())},f.pause=function(){f.paused=!0,f.tag.dispatchEvent(new CustomEvent("pause"))},f.stop=function(){f.currentFrame=-1,f.buffer&&(f.buffer.index=f.firstSequenceHeader),f.paused=!0,f.client&&(f.client.close(),f.client=null),f.tag.dispatchEvent(new CustomEvent("stop"))},f.seek=function(r,e){this.seekToFrame(r*this.pictureRate|0,e)},f.seekToFrame=function(r,t){if(r<0||r>=f.frameCount||!f.intraFrames.length)return!1;for(var a=null,o=0;o<f.intraFrames.length&&f.intraFrames[o].frame<=r;o++)a=f.intraFrames[o];if(f.buffer.index=a.index,f.currentFrame=a.frame-1,t){for(var n=a.frame;n<r;n++)k(e),f.findStartCode(p);f.currentFrame=r-1}return k(),!0},f.readCode=function(r){var e=0;do{e=r[e+this.buffer.getBits(1)]}while(e>=0&&0!==r[e]);return r[e+2]},f.findStartCode=function(r){for(var e=0;;)if((e=this.buffer.findNextMPEGStartCode())===r||-1===e)return e;return-1},f.fillArray=function(r,e){for(var t=0,a=r.length;t<a;t++)r[t]=e},f.pictureRate=30,f.lateTime=0,f.firstSequenceHeader=0,f.targetTime=0,f.benchmark=!1,f.benchFrame=0,f.benchDecodeTimes=0,f.benchAvgFrameTime=0,f.now=function(){return r.performance?r.performance.now():Date.now()},f.nextFrame=function(){if(f.buffer)for(var r=f.now();;){var e=f.buffer.findNextMPEGStartCode();if(e===v)D();else{if(e===p)return f.paused||u(),k(),f.benchDecodeTimes+=f.now()-r,f.canvas;if(-1===e)return f.stop(),f.tag.dispatchEvent(new CustomEvent("ended")),f.loop&&f.sequenceStarted&&f.play(),null}}},f.currentY=null,f.currentCr=null,f.currentCb=null,f.currentRGBA=null,f.pictureCodingType=0,f.forwardY=null,f.forwardCr=null,f.forwardCb=null,f.fullPelForward=!1,f.forwardFCode=0,f.forwardRSize=0,f.forwardF=0,f.renderFrame2D=function(){!function(){for(var r,e,t,a,o,n=f.currentY,i=f.currentCb,c=f.currentCr,d=f.currentRGBA.data,u=0,m=f.codedWidth,l=f.codedWidth+(f.codedWidth-f.width),s=0,b=f.halfWidth-(f.width>>1),w=0,g=4*f.width,h=4*f.width,C=f.width>>1,v=f.height>>1,T=0;T<v;T++){for(var x=0;x<C;x++){r=i[s],e=c[s],s++,t=e+(103*e>>8)-179,a=(88*r>>8)-44+(183*e>>8)-91,o=r+(198*r>>8)-227;var p=n[u++],F=n[u++];d[w]=p+t,d[w+1]=p-a,d[w+2]=p+o,d[w+4]=F+t,d[w+5]=F-a,d[w+6]=F+o,w+=8;var y=n[m++],A=n[m++];d[g]=y+t,d[g+1]=y-a,d[g+2]=y+o,d[g+4]=A+t,d[g+5]=A-a,d[g+6]=A+o,g+=8}u+=l,m+=l,w+=h,g+=h,s+=b}}(),f.canvasContext.putImageData(f.currentRGBA,0,0)},f.gl=null,f.program=null,f.YTexture=null,f.CBTexture=null,f.CRTexture=null,f.createTexture=function(r,e){var t=this.gl,a=t.createTexture();return t.bindTexture(t.TEXTURE_2D,a),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.uniform1i(t.getUniformLocation(this.program,e),r),a},f.compileShader=function(r,e){var t=this.gl,a=t.createShader(r);if(t.shaderSource(a,e),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(a));return a},f.quantizerScale=0,f.sliceBegin=!1,f.macroblockAddress=0,f.mbRow=0,f.mbCol=0,f.macroblockType=0,f.macroblockIntra=!1,f.macroblockMotFw=!1,f.motionFwH=0,f.motionFwV=0,f.motionFwHPrev=0,f.motionFwVPrev=0,f.decodeMacroblock=function(){for(var r=0,e=f.readCode(c);34===e;)e=f.readCode(c);for(;35===e;)r+=33,e=f.readCode(c);if(r+=e,f.sliceBegin)f.sliceBegin=!1,f.macroblockAddress+=r;else{if(f.macroblockAddress+r>=f.mbSize)return;for(r>1&&(f.dcPredictorY=128,f.dcPredictorCr=128,f.dcPredictorCb=128,f.pictureCodingType===h&&(f.motionFwH=f.motionFwHPrev=0,f.motionFwV=f.motionFwVPrev=0));r>1;)f.macroblockAddress++,f.mbRow=f.macroblockAddress/f.mbWidth|0,f.mbCol=f.macroblockAddress%f.mbWidth,B(f.motionFwH,f.motionFwV,f.forwardY,f.forwardCr,f.forwardCb),r--;f.macroblockAddress++}f.mbRow=f.macroblockAddress/f.mbWidth|0,f.mbCol=f.macroblockAddress%f.mbWidth,f.macroblockType=f.readCode(R[f.pictureCodingType]),f.macroblockIntra=1&f.macroblockType,f.macroblockMotFw=8&f.macroblockType,0!=(16&f.macroblockType)&&(f.quantizerScale=f.buffer.getBits(5)),f.macroblockIntra?(f.motionFwH=f.motionFwHPrev=0,f.motionFwV=f.motionFwVPrev=0):(f.dcPredictorY=128,f.dcPredictorCr=128,f.dcPredictorCb=128,f.decodeMotionVectors(),B(f.motionFwH,f.motionFwV,f.forwardY,f.forwardCr,f.forwardCb));for(var t=0!=(2&f.macroblockType)?f.readCode(m):f.macroblockIntra?63:0,a=0,o=32;a<6;a++)0!=(t&o)&&H(a),o>>=1},f.decodeMotionVectors=function(){var r,e,t=0;f.macroblockMotFw?(0!==(r=f.readCode(l))&&1!==f.forwardF?(t=f.buffer.getBits(f.forwardRSize),e=(Math.abs(r)-1<<f.forwardRSize)+t+1,r<0&&(e=-e)):e=r,f.motionFwHPrev+=e,f.motionFwHPrev>(f.forwardF<<4)-1?f.motionFwHPrev-=f.forwardF<<5:f.motionFwHPrev<-f.forwardF<<4&&(f.motionFwHPrev+=f.forwardF<<5),f.motionFwH=f.motionFwHPrev,f.fullPelForward&&(f.motionFwH<<=1),0!==(r=f.readCode(l))&&1!==f.forwardF?(t=f.buffer.getBits(f.forwardRSize),e=(Math.abs(r)-1<<f.forwardRSize)+t+1,r<0&&(e=-e)):e=r,f.motionFwVPrev+=e,f.motionFwVPrev>(f.forwardF<<4)-1?f.motionFwVPrev-=f.forwardF<<5:f.motionFwVPrev<-f.forwardF<<4&&(f.motionFwVPrev+=f.forwardF<<5),f.motionFwV=f.motionFwVPrev,f.fullPelForward&&(f.motionFwV<<=1)):f.pictureCodingType===h&&(f.motionFwH=f.motionFwHPrev=0,f.motionFwV=f.motionFwVPrev=0)},f.fillArray(f.zeroBlockData,0);var N=d.target;return N.mpgScreen?(f.canvas=N.mpgScreen,f.canvas.width=N.css.width,f.canvas.height=N.css.height):(f.canvas=document.createElement("canvas"),f.canvas.width=d.css.width,f.canvas.height=d.css.height,N.appendChild(f.canvas)),f.canvas.style.position="absolute",!d.forceCanvas2D&&function(){var r;try{r=f.gl=f.canvas.getContext("webgl")||f.canvas.getContext("experimental-webgl")}catch(r){return!1}if(!r)return!1;if(f.buffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,f.buffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),r.STATIC_DRAW),f.program=r.createProgram(),r.attachShader(f.program,f.compileShader(r.VERTEX_SHADER,P)),r.attachShader(f.program,f.compileShader(r.FRAGMENT_SHADER,A)),r.linkProgram(f.program),!r.getProgramParameter(f.program,r.LINK_STATUS))throw new Error(r.getProgramInfoLog(f.program));r.useProgram(f.program),f.YTexture=f.createTexture(0,"YTexture"),f.CBTexture=f.createTexture(1,"CBTexture"),f.CRTexture=f.createTexture(2,"CRTexture");var e=r.getAttribLocation(f.program,"vertex");return r.enableVertexAttribArray(e),r.vertexAttribPointer(e,2,r.FLOAT,!1,0,0),f.loadingProgram=r.createProgram(),r.attachShader(f.loadingProgram,f.compileShader(r.VERTEX_SHADER,P)),r.attachShader(f.loadingProgram,f.compileShader(r.FRAGMENT_SHADER,E)),r.linkProgram(f.loadingProgram),r.useProgram(f.loadingProgram),e=r.getAttribLocation(f.loadingProgram,"vertex"),r.enableVertexAttribArray(e),r.vertexAttribPointer(e,2,r.FLOAT,!1,0,0),!0}()?f.renderFrame=function(){var r=f.gl,e=new Uint8Array(f.currentY.buffer),t=new Uint8Array(f.currentCr.buffer),a=new Uint8Array(f.currentCb.buffer);r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,f.YTexture),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,f.codedWidth,f.height,0,r.LUMINANCE,r.UNSIGNED_BYTE,e),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,f.CBTexture),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,f.halfWidth,f.height/2,0,r.LUMINANCE,r.UNSIGNED_BYTE,t),r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,f.CRTexture),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,f.halfWidth,f.height/2,0,r.LUMINANCE,r.UNSIGNED_BYTE,a),r.drawArrays(r.TRIANGLE_STRIP,0,4)}:(f.canvasContext=f.canvas.getContext("2d"),f.renderFrame=f.renderFrame2D),f.src=d.source,f.load(d.source),f};var e=1,t=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],a=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),n=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),i=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),c=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),d=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),f=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),u=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),m=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),l=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),s=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),b=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),w=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),g=1,h=2,C=3,v=179,T=1,x=175,p=0,F=181,y=178,A=["precision mediump float;","uniform sampler2D YTexture;","uniform sampler2D CBTexture;","uniform sampler2D CRTexture;","varying vec2 texCoord;","void main() {","float y = texture2D(YTexture, texCoord).r;","float cr = texture2D(CBTexture, texCoord).r - 0.5;","float cb = texture2D(CRTexture, texCoord).r - 0.5;","gl_FragColor = vec4(","y + 1.4 * cr,","y + -0.343 * cb - 0.711 * cr,","y + 1.765 * cb,","1.0",");","}"].join("\n"),E=["precision mediump float;","uniform float loaded;","varying vec2 texCoord;","void main() {","float c = ceil(loaded-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),P=["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n"),R=[null,d,f,u],S=function(r){var e=this;e.bytes=new Uint8Array(r),e.length=e.bytes.length,e.writePos=e.bytes.length,e.index=0};S.prototype={findNextMPEGStartCode:function(){for(var r=this,e=r.index+7>>3;e<r.writePos;e++)if(0===r.bytes[e]&&0===r.bytes[e+1]&&1===r.bytes[e+2])return r.index=e+4<<3,r.bytes[e+3];return r.index=r.writePos<<3,-1},nextBytesAreStartCode:function(){var r=this,e=r.index+7>>3;return e>=r.writePos||0===r.bytes[e]&&0===r.bytes[e+1]&&1===r.bytes[e+2]},nextBits:function(r){var e=this,t=e.index>>3,a=8-e.index%8;if(a>=r)return e.bytes[t]>>a-r&255>>8-r;var o=(e.index+r)%8,n=e.index+r-1>>3,i=e.bytes[t]&255>>8-a;for(t++;t<n;t++)i<<=8,i|=e.bytes[t];return o>0?(i<<=o,i|=e.bytes[t]>>8-o):(i<<=8,i|=e.bytes[t]),i},getBits:function(r){var e=this.nextBits(r);return this.index+=r,e},advance:function(r){return this.index+=r},rewind:function(r){return this.index-=r}}}(window);