!function(a){"use strict";var d=(a.MpegPlugin=function(b){function l(){function c(){a.requestAnimationFrame(k.nextFrame.bind(k),k.canvas)}k.lateTime=k.now()-k.targetTime;var b=Math.max(0,1e3/k.pictureRate-k.lateTime);k.targetTime=k.now()+b,k.benchmark?(k.benchFrame++,k.benchFrame>=120&&(k.benchAvgFrameTime=k.benchDecodeTimes/k.benchFrame,k.benchFrame=0,k.benchDecodeTimes=0,a.console&&console.log("Average time per frame:",k.benchAvgFrameTime,"ms")),setTimeout(k.nextFrame.bind(k),0)):b<18?c():setTimeout(c,b)}function m(){if(k.width=k.buffer.getBits(12),k.height=k.buffer.getBits(12),k.buffer.advance(4),k.pictureRate=e[k.buffer.getBits(4)],k.buffer.advance(30),k.intraQuantMatrix=g,k.nonIntraQuantMatrix=h,k.mbWidth=k.width+15>>4,k.mbHeight=k.height+15>>4,k.mbSize=k.mbWidth*k.mbHeight,k.codedWidth=k.mbWidth<<4,k.codedHeight=k.mbHeight<<4,k.codedSize=k.codedWidth*k.codedHeight,k.halfWidth=k.mbWidth<<3,k.halfHeight=k.mbHeight<<3,k.quarterSize=k.codedSize>>2,!k.sequenceStarted){k.sequenceStarted=!0;var b=a.Uint8ClampedArray||a.Uint8Array;a.Uint8ClampedArray||(M=O,N=P),k.currentY=new b(k.codedSize),k.currentY32=new Uint32Array(k.currentY.buffer),k.currentCr=new b(k.codedSize>>2),k.currentCr32=new Uint32Array(k.currentCr.buffer),k.currentCb=new b(k.codedSize>>2),k.currentCb32=new Uint32Array(k.currentCb.buffer),k.forwardY=new b(k.codedSize),k.forwardY32=new Uint32Array(k.forwardY.buffer),k.forwardCr=new b(k.codedSize>>2),k.forwardCr32=new Uint32Array(k.forwardCr.buffer),k.forwardCb=new b(k.codedSize>>2),k.forwardCb32=new Uint32Array(k.forwardCb.buffer);var c=k.canvas;if(k.gl?(k.gl.useProgram(k.program),k.gl.viewport(0,0,c.width,c.height)):(k.currentRGBA=k.canvasContext.getImageData(0,0,c.width,c.height),k.fillArray(k.currentRGBA.data,255)),k.buffer.getBits(1)){for(var d=0;d<64;d++)k.customIntraQuantMatrix[f[d]]=k.buffer.getBits(8);k.intraQuantMatrix=k.customIntraQuantMatrix}if(k.buffer.getBits(1)){for(var d=0;d<64;d++)k.customNonIntraQuantMatrix[f[d]]=k.buffer.getBits(8);k.nonIntraQuantMatrix=k.customNonIntraQuantMatrix}}}function G(a){var b=k.buffer;if(k.currentFrame++,k.currentTime=k.currentFrame/k.pictureRate,b.advance(10),k.pictureCodingType=b.getBits(3),b.advance(16),!(k.pictureCodingType<=0||k.pictureCodingType>=u)){if(k.pictureCodingType===t){if(k.fullPelForward=b.getBits(1),k.forwardFCode=b.getBits(3),0===k.forwardFCode)return;k.forwardRSize=k.forwardFCode-1,k.forwardF=1<<k.forwardRSize}var c=0;do c=b.findNextMPEGStartCode();while(c===z||c===A);for(;c>=w&&c<=x;)K(255&c),c=b.findNextMPEGStartCode();if(b.rewind(32),a!==d&&(k.renderFrame(),k.externalDecodeCallback.call(k,k.canvas)),k.pictureCodingType===s||k.pictureCodingType===t){var e=k.forwardY,f=k.forwardY32,g=k.forwardCr,h=k.forwardCr32,i=k.forwardCb,j=k.forwardCb32;k.forwardY=k.currentY,k.forwardY32=k.currentY32,k.forwardCr=k.currentCr,k.forwardCr32=k.currentCr32,k.forwardCb=k.currentCb,k.forwardCb32=k.currentCb32,k.currentY=e,k.currentY32=f,k.currentCr=g,k.currentCr32=h,k.currentCb=i,k.currentCb32=j}}}function H(){for(var p,q,r,s,t,a=k.currentY,b=k.currentCb,c=k.currentCr,d=k.currentRGBA.data,e=0,f=k.codedWidth,g=k.codedWidth+(k.codedWidth-k.width),h=0,i=k.halfWidth-(k.width>>1),j=0,l=4*k.width,m=4*k.width,n=k.width>>1,o=k.height>>1,u=0;u<o;u++){for(var v=0;v<n;v++){p=b[h],q=c[h],h++,r=q+(103*q>>8)-179,s=(88*p>>8)-44+(183*q>>8)-91,t=p+(198*p>>8)-227;var w=a[e++],x=a[e++];d[j]=w+r,d[j+1]=w-s,d[j+2]=w+t,d[j+4]=x+r,d[j+5]=x-s,d[j+6]=x+t,j+=8;var y=a[f++],z=a[f++];d[l]=y+r,d[l+1]=y-s,d[l+2]=y+t,d[l+4]=z+r,d[l+5]=z-s,d[l+6]=z+t,l+=8}e+=g,f+=g,j+=m,l+=m,h+=i}}function I(){var a;try{a=k.gl=k.canvas.getContext("webgl")||k.canvas.getContext("experimental-webgl")}catch(a){return!1}if(!a)return!1;if(k.buffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,k.buffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),a.STATIC_DRAW),k.program=a.createProgram(),a.attachShader(k.program,k.compileShader(a.VERTEX_SHADER,D)),a.attachShader(k.program,k.compileShader(a.FRAGMENT_SHADER,B)),a.linkProgram(k.program),!a.getProgramParameter(k.program,a.LINK_STATUS))throw new Error(a.getProgramInfoLog(k.program));a.useProgram(k.program),k.YTexture=k.createTexture(0,"YTexture"),k.CBTexture=k.createTexture(1,"CBTexture"),k.CRTexture=k.createTexture(2,"CRTexture");var b=a.getAttribLocation(k.program,"vertex");return a.enableVertexAttribArray(b),a.vertexAttribPointer(b,2,a.FLOAT,!1,0,0),k.loadingProgram=a.createProgram(),a.attachShader(k.loadingProgram,k.compileShader(a.VERTEX_SHADER,D)),a.attachShader(k.loadingProgram,k.compileShader(a.FRAGMENT_SHADER,C)),a.linkProgram(k.loadingProgram),a.useProgram(k.loadingProgram),b=a.getAttribLocation(k.loadingProgram,"vertex"),a.enableVertexAttribArray(b),a.vertexAttribPointer(b,2,a.FLOAT,!1,0,0),!0}function J(){var a=k.gl,b=new Uint8Array(k.currentY.buffer),c=new Uint8Array(k.currentCr.buffer),d=new Uint8Array(k.currentCb.buffer);a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,k.YTexture),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,k.codedWidth,k.height,0,a.LUMINANCE,a.UNSIGNED_BYTE,b),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,k.CBTexture),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,k.halfWidth,k.height/2,0,a.LUMINANCE,a.UNSIGNED_BYTE,c),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,k.CRTexture),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,k.halfWidth,k.height/2,0,a.LUMINANCE,a.UNSIGNED_BYTE,d),a.drawArrays(a.TRIANGLE_STRIP,0,4)}function K(a){for(k.sliceBegin=!0,k.macroblockAddress=(a-1)*k.mbWidth-1,k.motionFwH=k.motionFwHPrev=0,k.motionFwV=k.motionFwVPrev=0,k.dcPredictorY=128,k.dcPredictorCr=128,k.dcPredictorCb=128,k.quantizerScale=k.buffer.getBits(5);k.buffer.getBits(1);)k.buffer.advance(8);do k.decodeMacroblock();while(!k.buffer.nextBytesAreStartCode())}function L(a,b,c,d,e){var f,g,h,i,j,l,m,n,o,p=k.currentY32,q=k.currentCb32,r=k.currentCr32;f=k.codedWidth,g=f-16,h=a>>1,i=b>>1,j=1===(1&a),l=1===(1&b),m=((k.mbRow<<4)+i)*f+(k.mbCol<<4)+h,n=k.mbRow*f+k.mbCol<<2,o=n+(f<<2);var s,t,u,v;if(j)if(l)for(;n<o;){for(t=c[m]+c[m+f],m++,s=0;s<4;s++)u=c[m]+c[m+f],m++,v=t+u+2>>2&255,t=c[m]+c[m+f],m++,v|=t+u+2<<6&65280,u=c[m]+c[m+f],m++,v|=t+u+2<<14&16711680,t=c[m]+c[m+f],m++,v|=t+u+2<<22&4278190080,p[n++]=v;n+=g>>2,m+=g-1}else for(;n<o;){for(t=c[m++],s=0;s<4;s++)u=c[m++],v=t+u+1>>1&255,t=c[m++],v|=t+u+1<<7&65280,u=c[m++],v|=t+u+1<<15&16711680,t=c[m++],v|=t+u+1<<23&4278190080,p[n++]=v;n+=g>>2,m+=g-1}else if(l)for(;n<o;){for(s=0;s<4;s++)v=c[m]+c[m+f]+1>>1&255,m++,v|=c[m]+c[m+f]+1<<7&65280,m++,v|=c[m]+c[m+f]+1<<15&16711680,m++,v|=c[m]+c[m+f]+1<<23&4278190080,m++,p[n++]=v;n+=g>>2,m+=g}else for(;n<o;){for(s=0;s<4;s++)v=c[m],m++,v|=c[m]<<8,m++,v|=c[m]<<16,m++,v|=c[m]<<24,m++,p[n++]=v;n+=g>>2,m+=g}f=k.halfWidth,g=f-8,h=a/2>>1,i=b/2>>1,j=1===(a/2&1),l=1===(b/2&1),m=((k.mbRow<<3)+i)*f+(k.mbCol<<3)+h,n=k.mbRow*f+k.mbCol<<1,o=n+(f<<1);var w,x,y,z,A,B;if(j)if(l)for(;n<o;){for(w=d[m]+d[m+f],z=e[m]+e[m+f],m++,s=0;s<2;s++)x=d[m]+d[m+f],A=e[m]+e[m+f],m++,y=w+x+2>>2&255,B=z+A+2>>2&255,w=d[m]+d[m+f],z=e[m]+e[m+f],m++,y|=w+x+2<<6&65280,B|=z+A+2<<6&65280,x=d[m]+d[m+f],A=e[m]+e[m+f],m++,y|=w+x+2<<14&16711680,B|=z+A+2<<14&16711680,w=d[m]+d[m+f],z=e[m]+e[m+f],m++,y|=w+x+2<<22&4278190080,B|=z+A+2<<22&4278190080,r[n]=y,q[n]=B,n++;n+=g>>2,m+=g-1}else for(;n<o;){for(w=d[m],z=e[m],m++,s=0;s<2;s++)x=d[m],A=e[m++],y=w+x+1>>1&255,B=z+A+1>>1&255,w=d[m],z=e[m++],y|=w+x+1<<7&65280,B|=z+A+1<<7&65280,x=d[m],A=e[m++],y|=w+x+1<<15&16711680,B|=z+A+1<<15&16711680,w=d[m],z=e[m++],y|=w+x+1<<23&4278190080,B|=z+A+1<<23&4278190080,r[n]=y,q[n]=B,n++;n+=g>>2,m+=g-1}else if(l)for(;n<o;){for(s=0;s<2;s++)y=d[m]+d[m+f]+1>>1&255,B=e[m]+e[m+f]+1>>1&255,m++,y|=d[m]+d[m+f]+1<<7&65280,B|=e[m]+e[m+f]+1<<7&65280,m++,y|=d[m]+d[m+f]+1<<15&16711680,B|=e[m]+e[m+f]+1<<15&16711680,m++,y|=d[m]+d[m+f]+1<<23&4278190080,B|=e[m]+e[m+f]+1<<23&4278190080,m++,r[n]=y,q[n]=B,n++;n+=g>>2,m+=g}else for(;n<o;){for(s=0;s<2;s++)y=d[m],B=e[m],m++,y|=d[m]<<8,B|=e[m]<<8,m++,y|=d[m]<<16,B|=e[m]<<16,m++,y|=d[m]<<24,B|=e[m]<<24,m++,r[n]=y,q[n]=B,n++;n+=g>>2,m+=g}}function M(a,b,c,d){for(var e=0;e<64;e+=8,c+=d+8)b[c+0]=a[e+0],b[c+1]=a[e+1],b[c+2]=a[e+2],b[c+3]=a[e+3],b[c+4]=a[e+4],b[c+5]=a[e+5],b[c+6]=a[e+6],b[c+7]=a[e+7]}function N(a,b,c,d){for(var e=0;e<64;e+=8,c+=d+8)b[c+0]+=a[e+0],b[c+1]+=a[e+1],b[c+2]+=a[e+2],b[c+3]+=a[e+3],b[c+4]+=a[e+4],b[c+5]+=a[e+5],b[c+6]+=a[e+6],b[c+7]+=a[e+7]}function O(a,b,c,d){for(var e=0,f=0;f<8;f++){for(var g=0;g<8;g++){var h=a[e++];b[c++]=h>255?255:h<0?0:h}c+=d}}function P(a,b,c,d){for(var e=0,f=0;f<8;f++){for(var g=0;g<8;g++){var h=a[e++]+b[c];b[c++]=h>255?255:h<0?0:h}c+=d}}function Q(a){function t(a,b,c,d){for(var e=0;e<64;e+=8,c+=d+8)b[c+0]=a,b[c+1]=a,b[c+2]=a,b[c+3]=a,b[c+4]=a,b[c+5]=a,b[c+6]=a,b[c+7]=a}function u(a,b,c,d){for(var e=0;e<64;e+=8,c+=d+8)b[c+0]+=a,b[c+1]+=a,b[c+2]+=a,b[c+3]+=a,b[c+4]+=a,b[c+5]+=a,b[c+6]+=a,b[c+7]+=a}function v(){var a,b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t,u=k.blockData;for(t=0;t<8;++t)a=u[32+t],b=u[16+t]+u[48+t],c=u[40+t]-u[24+t],f=u[8+t]+u[56+t],g=u[24+t]+u[40+t],d=u[8+t]-u[56+t],e=f+g,h=u[0+t],n=(473*d-196*c+128>>8)-e,i=n-(362*(f-g)+128>>8),j=h-a,l=(362*(u[16+t]-u[48+t])+128>>8)-b,m=h+a,o=j+l,p=m+b,q=j-l,r=m-b,s=-i-(473*c+196*d+128>>8),u[0+t]=e+p,u[8+t]=n+o,u[16+t]=q-i,u[24+t]=r-s,u[32+t]=r+s,u[40+t]=i+q,u[48+t]=o-n,u[56+t]=p-e;for(t=0;t<64;t+=8)a=u[4+t],b=u[2+t]+u[6+t],c=u[5+t]-u[3+t],f=u[1+t]+u[7+t],g=u[3+t]+u[5+t],d=u[1+t]-u[7+t],e=f+g,h=u[0+t],n=(473*d-196*c+128>>8)-e,i=n-(362*(f-g)+128>>8),j=h-a,l=(362*(u[2+t]-u[6+t])+128>>8)-b,m=h+a,o=j+l,p=m+b,q=j-l,r=m-b,s=-i-(473*c+196*d+128>>8),u[0+t]=e+p+128>>8,u[1+t]=n+o+128>>8,u[2+t]=q-i+128>>8,u[3+t]=r-s+128>>8,u[4+t]=r+s+128>>8,u[5+t]=i+q+128>>8,u[6+t]=o-n+128>>8,u[7+t]=p-e+128>>8}var c,b=0;if(k.macroblockIntra){var d,e;if(a<4?(d=k.dcPredictorY,e=k.readCode(p)):(d=4===a?k.dcPredictorCr:k.dcPredictorCb,e=k.readCode(q)),e>0){var g=k.buffer.getBits(e);0!==(g&1<<e-1)?k.blockData[0]=d+g:k.blockData[0]=d+(-1<<e|g+1)}else k.blockData[0]=d;a<4?k.dcPredictorY=k.blockData[0]:4===a?k.dcPredictorCr=k.blockData[0]:k.dcPredictorCb=k.blockData[0],k.blockData[0]<<=8,c=k.intraQuantMatrix,b=1}else c=k.nonIntraQuantMatrix;for(var h=0;;){var j=0,l=k.readCode(r);if(1===l&&b>0&&0===k.buffer.getBits(1))break;65535===l?(j=k.buffer.getBits(6),h=k.buffer.getBits(8),0===h?h=k.buffer.getBits(8):128===h?h=k.buffer.getBits(8)-256:h>128&&(h-=256)):(j=l>>8,h=255&l,k.buffer.getBits(1)&&(h=-h)),b+=j;var m=f[b];b++,h<<=1,k.macroblockIntra||(h+=h<0?-1:1),h=h*k.quantizerScale*c[m]>>4,0===(1&h)&&(h-=h>0?1:-1),h>2047?h=2047:h<-2048&&(h=-2048),k.blockData[m]=h*i[m]}var n,o,s;a<4?(n=k.currentY,s=k.codedWidth-8,o=k.mbRow*k.codedWidth+k.mbCol<<4,0!==(1&a)&&(o+=8),0!==(2&a)&&(o+=k.codedWidth<<3)):(n=4===a?k.currentCb:k.currentCr,s=(k.codedWidth>>1)-8,o=(k.mbRow*k.codedWidth<<2)+(k.mbCol<<3)),1===b?(k.macroblockIntra?t(k.blockData[0]+128>>8,n,o,s):u(k.blockData[0]+128>>8,n,o,s),k.blockData[0]=0):(v(),k.macroblockIntra?M(k.blockData,n,o,s):N(k.blockData,n,o,s),k.blockData.set(k.zeroBlockData)),b=0}var c=3;trace(Array(100).join("/"),"\n\tMpegPlugin\tV :",c),b=b||{};var k=document.createElement("span");k.tag=b.tag||document.createElement("video"),k.buffered=0,k.paused=!0,k.benchmark=!!b.benchmark,k.autoplay=b.autoplay!==!1,k.loop=!!b.loop,k.onReady=b.onReady||function(){},k.externalDecodeCallback=b.ondecodeframe||function(){},k.onComplete=b.onComplete||function(){},k.customIntraQuantMatrix=new Uint8Array(64),k.customNonIntraQuantMatrix=new Uint8Array(64),k.blockData=new Int32Array(64),k.zeroBlockData=new Int32Array(64),k.intraFrames=[],k.currentFrame=-1,k.currentTime=0,k.frameCount=0,k.duration=0,k.load=function(a){function c(a){var b=a.loaded/a.total,c=k.canvas.width,d=k.canvas.height,e=k.canvasContext;e.fillStyle="#222",e.fillRect(0,0,c,d),e.fillStyle="#fff",e.fillRect(0,d-d*b,c,d*b)}function d(a){var b=k.gl;b.uniform1f(b.getUniformLocation(k.loadingProgram,"loaded"),a.loaded/a.total),b.drawArrays(b.TRIANGLE_STRIP,0,4)}function e(a){k.buffer=new F(a),f(),k.buffer.index=0,k.findStartCode(v),k.firstSequenceHeader=k.buffer.index,m(),k.duration=k.frameCount/k.pictureRate,k.nextFrame(),k.autoplay&&k.play(),k.onReady.call(k)}function f(){var a;for(a=0;k.findStartCode(y)!==-1;a++)k.buffer.advance(10),k.buffer.getBits(3)===s&&k.intraFrames.push({frame:a,index:k.buffer.index-13});k.frameCount=a}var b=new XMLHttpRequest;k.url=a,b.onreadystatechange=function(){b.readyState===b.DONE&&200===b.status&&e(b.response)},b.onprogress=k.gl?d:c,b.open("GET",a),b.responseType="arraybuffer",b.send()},k.play=function(){k.paused&&(k.tag.dispatchEvent(new CustomEvent("play")),k.tag.dispatchEvent(new CustomEvent("playing")),k.targetTime=k.now(),k.paused=!1,l())},k.pause=function(){k.paused=!0,k.tag.dispatchEvent(new CustomEvent("pause"))},k.stop=function(){k.currentFrame=-1,k.buffer&&(k.buffer.index=k.firstSequenceHeader),k.paused=!0,k.client&&(k.client.close(),k.client=null)},k.seek=function(a,b){this.seekToFrame(a*this.pictureRate|0,b)},k.seekToFrame=function(a,b){if(a<0||a>=k.frameCount||!k.intraFrames.length)return!1;for(var c=null,e=0;e<k.intraFrames.length&&k.intraFrames[e].frame<=a;e++)c=k.intraFrames[e];if(k.buffer.index=c.index,k.currentFrame=c.frame-1,b){for(var f=c.frame;f<a;f++)G(d),k.findStartCode(y);k.currentFrame=a-1}return G(),!0},k.readCode=function(a){var b=0;do b=a[b+this.buffer.getBits(1)];while(b>=0&&0!==a[b]);return a[b+2]},k.findStartCode=function(a){for(var b=0;;)if(b=this.buffer.findNextMPEGStartCode(),b===a||b===-1)return b;return-1},k.fillArray=function(a,b){for(var c=0,d=a.length;c<d;c++)a[c]=b},k.pictureRate=30,k.lateTime=0,k.firstSequenceHeader=0,k.targetTime=0,k.benchmark=!1,k.benchFrame=0,k.benchDecodeTimes=0,k.benchAvgFrameTime=0,k.now=function(){return a.performance?a.performance.now():Date.now()},k.nextFrame=function(){if(k.buffer)for(var a=k.now();;){var b=k.buffer.findNextMPEGStartCode();if(b===v)m();else{if(b===y)return k.paused||l(),G(),k.benchDecodeTimes+=k.now()-a,k.canvas;if(b===-1)return k.stop(),k.tag.dispatchEvent(new CustomEvent("ended")),k.onComplete.call(k),k.loop&&k.sequenceStarted&&k.play(),null}}},k.currentY=null,k.currentCr=null,k.currentCb=null,k.currentRGBA=null,k.pictureCodingType=0,k.forwardY=null,k.forwardCr=null,k.forwardCb=null,k.fullPelForward=!1,k.forwardFCode=0,k.forwardRSize=0,k.forwardF=0,k.renderFrame2D=function(){H(),k.canvasContext.putImageData(k.currentRGBA,0,0)},k.gl=null,k.program=null,k.YTexture=null,k.CBTexture=null,k.CRTexture=null,k.createTexture=function(a,b){var c=this.gl,d=c.createTexture();return c.bindTexture(c.TEXTURE_2D,d),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.uniform1i(c.getUniformLocation(this.program,b),a),d},k.compileShader=function(a,b){var c=this.gl,d=c.createShader(a);if(c.shaderSource(d,b),c.compileShader(d),!c.getShaderParameter(d,c.COMPILE_STATUS))throw new Error(c.getShaderInfoLog(d));return d},k.quantizerScale=0,k.sliceBegin=!1,k.macroblockAddress=0,k.mbRow=0,k.mbCol=0,k.macroblockType=0,k.macroblockIntra=!1,k.macroblockMotFw=!1,k.motionFwH=0,k.motionFwV=0,k.motionFwHPrev=0,k.motionFwVPrev=0,k.decodeMacroblock=function(){for(var a=0,b=k.readCode(j);34===b;)b=k.readCode(j);for(;35===b;)a+=33,b=k.readCode(j);if(a+=b,k.sliceBegin)k.sliceBegin=!1,k.macroblockAddress+=a;else{if(k.macroblockAddress+a>=k.mbSize)return;for(a>1&&(k.dcPredictorY=128,k.dcPredictorCr=128,k.dcPredictorCb=128,k.pictureCodingType===t&&(k.motionFwH=k.motionFwHPrev=0,k.motionFwV=k.motionFwVPrev=0));a>1;)k.macroblockAddress++,k.mbRow=k.macroblockAddress/k.mbWidth|0,k.mbCol=k.macroblockAddress%k.mbWidth,L(k.motionFwH,k.motionFwV,k.forwardY,k.forwardCr,k.forwardCb),a--;k.macroblockAddress++}k.mbRow=k.macroblockAddress/k.mbWidth|0,k.mbCol=k.macroblockAddress%k.mbWidth,k.macroblockType=k.readCode(E[k.pictureCodingType]),k.macroblockIntra=1&k.macroblockType,k.macroblockMotFw=8&k.macroblockType,0!==(16&k.macroblockType)&&(k.quantizerScale=k.buffer.getBits(5)),k.macroblockIntra?(k.motionFwH=k.motionFwHPrev=0,k.motionFwV=k.motionFwVPrev=0):(k.dcPredictorY=128,k.dcPredictorCr=128,k.dcPredictorCb=128,k.decodeMotionVectors(),L(k.motionFwH,k.motionFwV,k.forwardY,k.forwardCr,k.forwardCb));for(var c=0!==(2&k.macroblockType)?k.readCode(n):k.macroblockIntra?63:0,d=0,e=32;d<6;d++)0!==(c&e)&&Q(d),e>>=1},k.decodeMotionVectors=function(){var a,b,c=0;k.macroblockMotFw?(a=k.readCode(o),0!==a&&1!==k.forwardF?(c=k.buffer.getBits(k.forwardRSize),b=(Math.abs(a)-1<<k.forwardRSize)+c+1,a<0&&(b=-b)):b=a,k.motionFwHPrev+=b,k.motionFwHPrev>(k.forwardF<<4)-1?k.motionFwHPrev-=k.forwardF<<5:k.motionFwHPrev<-k.forwardF<<4&&(k.motionFwHPrev+=k.forwardF<<5),k.motionFwH=k.motionFwHPrev,k.fullPelForward&&(k.motionFwH<<=1),a=k.readCode(o),0!==a&&1!==k.forwardF?(c=k.buffer.getBits(k.forwardRSize),b=(Math.abs(a)-1<<k.forwardRSize)+c+1,a<0&&(b=-b)):b=a,k.motionFwVPrev+=b,k.motionFwVPrev>(k.forwardF<<4)-1?k.motionFwVPrev-=k.forwardF<<5:k.motionFwVPrev<-k.forwardF<<4&&(k.motionFwVPrev+=k.forwardF<<5),k.motionFwV=k.motionFwVPrev,k.fullPelForward&&(k.motionFwV<<=1)):k.pictureCodingType===t&&(k.motionFwH=k.motionFwHPrev=0,k.motionFwV=k.motionFwVPrev=0)},k.fillArray(k.zeroBlockData,0);var R=b.target;return trace(R instanceof VideoPlayer,R),R instanceof VideoPlayer?(k.canvas=R.mpgScreen,k.canvas.width=R.css.width,k.canvas.height=R.css.height):(k.canvas=document.createElement("canvas"),k.canvas.width=b.css.width,k.canvas.height=b.css.height,R.appendChild(k.canvas)),k.canvas.style.position="absolute",!b.forceCanvas2D&&I()?k.renderFrame=J:(k.canvasContext=k.canvas.getContext("2d"),k.renderFrame=k.renderFrame2D),k.src=b.source,k.load(b.source),trace(Array(100).join("/")),k},1),e=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],f=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),g=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),h=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),i=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),j=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),k=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),l=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),m=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),n=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),o=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),p=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),q=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),r=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),s=1,t=2,u=3,v=179,w=1,x=175,y=0,z=181,A=178,B=["precision mediump float;","uniform sampler2D YTexture;","uniform sampler2D CBTexture;","uniform sampler2D CRTexture;","varying vec2 texCoord;","void main() {","float y = texture2D(YTexture, texCoord).r;","float cr = texture2D(CBTexture, texCoord).r - 0.5;","float cb = texture2D(CRTexture, texCoord).r - 0.5;","gl_FragColor = vec4(","y + 1.4 * cr,","y + -0.343 * cb - 0.711 * cr,","y + 1.765 * cb,","1.0",");","}"].join("\n"),C=["precision mediump float;","uniform float loaded;","varying vec2 texCoord;","void main() {","float c = ceil(loaded-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),D=["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n"),E=[null,k,l,m],F=function(a){var b=this;b.bytes=new Uint8Array(a),b.length=b.bytes.length,b.writePos=b.bytes.length,b.index=0};F.prototype={findNextMPEGStartCode:function(){for(var a=this,b=a.index+7>>3;b<a.writePos;b++)if(0===a.bytes[b]&&0===a.bytes[b+1]&&1===a.bytes[b+2])return a.index=b+4<<3,a.bytes[b+3];return a.index=a.writePos<<3,-1},nextBytesAreStartCode:function(){var a=this,b=a.index+7>>3;return b>=a.writePos||0===a.bytes[b]&&0===a.bytes[b+1]&&1===a.bytes[b+2]},nextBits:function(a){var b=this,c=b.index>>3,d=8-b.index%8;if(d>=a)return b.bytes[c]>>d-a&255>>8-a;var e=(b.index+a)%8,f=b.index+a-1>>3,g=b.bytes[c]&255>>8-d;for(c++;c<f;c++)g<<=8,g|=b.bytes[c];return e>0?(g<<=e,g|=b.bytes[c]>>8-e):(g<<=8,g|=b.bytes[c]),g},getBits:function(a){var b=this.nextBits(a);return this.index+=a,b},advance:function(a){return this.index+=a},rewind:function(a){return this.index-=a}}}(window);